// Code generated by enhanced-generator v2 from protocol.json; DO NOT EDIT manually.
// To regenerate: go run main_v2.go -protocol <path> -output <dir> -direction server

package server

import (
	pk "git.konjactw.dev/falloutBot/go-mc/net/packet"
	"git.konjactw.dev/patyhank/minego/pkg/protocol/packetid"
	"io"
)

// ChatCommandSignedArgumentSignaturesEntry is a sub-structure used in the packet.
type ChatCommandSignedArgumentSignaturesEntry struct {
	ArgumentName string `mc:"String"`
	Signature    []byte `mc:"ByteArray"`
}

// ReadFrom reads the data from the reader.
func (p *ChatCommandSignedArgumentSignaturesEntry) ReadFrom(r io.Reader) (n int64, err error) {
	var temp int64
	_ = temp

	var argumentName pk.String
	temp, err = argumentName.ReadFrom(r)
	n += temp
	if err != nil {
		return n, err
	}
	p.ArgumentName = string(argumentName)

	temp, err = (*pk.ByteArray)(&p.Signature).ReadFrom(r)
	n += temp
	if err != nil {
		return n, err
	}

	return n, nil
}

// WriteTo writes the data to the writer.
func (p ChatCommandSignedArgumentSignaturesEntry) WriteTo(w io.Writer) (n int64, err error) {
	var temp int64
	_ = temp

	temp, err = pk.String(p.ArgumentName).WriteTo(w)
	n += temp
	if err != nil {
		return n, err
	}

	temp, err = (*pk.ByteArray)(&p.Signature).WriteTo(w)
	n += temp
	if err != nil {
		return n, err
	}

	return n, nil
}

// ChatCommandSigned represents the Serverbound ChatCommandSigned packet.

type ChatCommandSigned struct {
	Command            string `mc:"String"`
	Timestamp          int64
	Salt               int64
	ArgumentSignatures []ChatCommandSignedArgumentSignaturesEntry
	MessageCount       int32  `mc:"VarInt"`
	Acknowledged       []byte `mc:"ByteArray"`
	Checksum           int8
}

// PacketID returns the packet ID for this packet.
func (*ChatCommandSigned) PacketID() packetid.ServerboundPacketID {
	return packetid.ServerboundChatCommandSigned
}

// ReadFrom reads the packet data from the reader.
func (p *ChatCommandSigned) ReadFrom(r io.Reader) (n int64, err error) {
	var temp int64
	_ = temp

	var command pk.String
	temp, err = command.ReadFrom(r)
	n += temp
	if err != nil {
		return n, err
	}
	p.Command = string(command)

	temp, err = (*pk.Long)(&p.Timestamp).ReadFrom(r)
	n += temp
	if err != nil {
		return n, err
	}

	temp, err = (*pk.Long)(&p.Salt).ReadFrom(r)
	n += temp
	if err != nil {
		return n, err
	}

	var argumentSignaturesCount pk.VarInt
	temp, err = argumentSignaturesCount.ReadFrom(r)
	n += temp
	if err != nil {
		return n, err
	}
	p.ArgumentSignatures = make([]ChatCommandSignedArgumentSignaturesEntry, argumentSignaturesCount)
	for i := 0; i < int(argumentSignaturesCount); i++ {
		temp, err = p.ArgumentSignatures[i].ReadFrom(r)
		n += temp
		if err != nil {
			return n, err
		}
	}

	var messageCount pk.VarInt
	temp, err = messageCount.ReadFrom(r)
	n += temp
	if err != nil {
		return n, err
	}
	p.MessageCount = int32(messageCount)

	temp, err = (*pk.ByteArray)(&p.Acknowledged).ReadFrom(r)
	n += temp
	if err != nil {
		return n, err
	}

	var checksum int8
	temp, err = (*pk.Byte)(&checksum).ReadFrom(r)
	n += temp
	if err != nil {
		return n, err
	}
	p.Checksum = checksum

	return n, nil
}

// WriteTo writes the packet data to the writer.
func (p ChatCommandSigned) WriteTo(w io.Writer) (n int64, err error) {
	var temp int64
	_ = temp

	temp, err = pk.String(p.Command).WriteTo(w)
	n += temp
	if err != nil {
		return n, err
	}

	temp, err = pk.Long(p.Timestamp).WriteTo(w)
	n += temp
	if err != nil {
		return n, err
	}

	temp, err = pk.Long(p.Salt).WriteTo(w)
	n += temp
	if err != nil {
		return n, err
	}

	temp, err = pk.VarInt(len(p.ArgumentSignatures)).WriteTo(w)
	n += temp
	if err != nil {
		return n, err
	}
	for i := range p.ArgumentSignatures {
		temp, err = p.ArgumentSignatures[i].WriteTo(w)
		n += temp
		if err != nil {
			return n, err
		}
	}

	temp, err = pk.VarInt(p.MessageCount).WriteTo(w)
	n += temp
	if err != nil {
		return n, err
	}

	temp, err = (*pk.ByteArray)(&p.Acknowledged).WriteTo(w)
	n += temp
	if err != nil {
		return n, err
	}

	temp, err = pk.Byte(p.Checksum).WriteTo(w)
	n += temp
	if err != nil {
		return n, err
	}

	return n, nil
}

func init() {
	registerPacket(packetid.ServerboundChatCommandSigned, func() ServerboundPacket {
		return &ChatCommandSigned{}
	})
}
